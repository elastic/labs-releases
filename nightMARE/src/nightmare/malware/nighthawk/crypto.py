# coding: utf-8


def decrypt_string(
    cleartext_alphabet: bytes, ciphertext_alphabet: bytes, encrypted_string: bytes
) -> bytes:
    """
    This function decrypts a string using NIGHTHAWK string substitution algorithm
    :param cleartext_alphabet: Cleartext alphabet used for string substitution algorithm
    :param ciphertext_alphabet: Ciphertext alphabet used for string substitution algorithm
    :param encrypted_string: Encrypted string we want to decrypt
    :return: Decrypted string
    """

    decoded_bytes = []
    for c in encrypted_string:
        if c in ciphertext_alphabet:
            decoded_bytes.append(cleartext_alphabet[ciphertext_alphabet.find(c)])
        else:
            decoded_bytes.append(c)

    return bytes(decoded_bytes)
