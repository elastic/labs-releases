# coding: utf-8

from nightmare import cast


def decrypt_string(encrypted_bytes: bytes) -> bytes:
    """
    This function decrypts encrypted strings using LATRODECTUS algorithm
    :param encrypted_string: Encrypted string we want to decrypt
    :return: Decrypted string
    """

    x = cast.u32(encrypted_bytes[:4])
    y = cast.u16(encrypted_bytes[4:6])
    byte_size = cast.u16(cast.p32(x ^ y)[:2])
    decoded_bytes = bytearray(byte_size)

    for i, b in enumerate(encrypted_bytes[6 : 6 + byte_size]):
        decoded_bytes[i] = ((x + i + 1) ^ b) % 256

    return bytes(decoded_bytes)
