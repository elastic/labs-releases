# coding: utf-8

import re
import string

C2_REGEX = re.compile(rb"((\w+\.)+\w+:\d+)(\||$|\s?)")
URL_REGEX = re.compile(rb"(https?://\S+)")


def find_c2_list(blob: bytes) -> list[bytes]:
    matches = C2_REGEX.findall(blob)
    return [m[0] for m in matches]


def find_embedded_urls(blob: bytes) -> list:
    matches = URL_REGEX.findall(blob)
    return [m.strip() for m in matches]


def contains_only_printable_characters(data: bytes) -> bool:
    printable = string.printable.encode("utf-8")
    for x in data:
        if not x in printable:
            return False
    return True
